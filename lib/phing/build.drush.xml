<?xml version="1.0"?>

<project name="Drush tasks" default="drush:help" description="Contains all the task used to enable and disable the various environments">

    <target name="drush:maintenance-mode-activate" description="Activates maintenance mode for the project.">
        <property name="active.site" value="default" />
        <fail unless="active.site" message="Active site not set." />
        <exec passthru="true"
              command="${bin.drush} state-set maintenance_mode 1 "
              dir="${dir.web.root}/sites/${active.site}"
              checkreturn="true"
        />
    </target>

    <target name="drush:maintenance-mode-deactivate" description="Deactivates maintenance mode for the project.">
        <property name="active.site" value="default" />
        <fail unless="active.site" message="Active site not set." />
        <exec passthru="true"
              command="${bin.drush} state-set maintenance_mode 0 "
              dir="${dir.web.root}/sites/${active.site}"
              checkreturn="true"
        />
    </target>

    <target name="drush:cache-rebuild" description="Rebuild the caches for the project.">
        <property name="active.site" value="default" />
        <fail unless="active.site" message="Active site not set." />
        <exec passthru="true"
              command="${bin.drush} cache-rebuild"
              dir="${dir.web.root}/sites/${active.site}"
              checkreturn="true"
        />
    </target>

    <target name="drush:config-import" description="Import the config for the project.">
        <property name="active.site" value="default" />
        <fail unless="active.site" message="Active site not set." />
        <exec passthru="true"
              command="${bin.drush} config-import -y"
              dir="${dir.web.root}/sites/${active.site}"
              checkreturn="true"
        />
    </target>

    <target name="drush:entity-updates" description="Complete the entity updates for the project.">
        <property name="active.site" value="default" />
        <fail unless="active.site" message="Active site not set." />
        <exec passthru="true"
              command="${bin.drush} entity-updates -y"
              dir="${dir.web.root}/sites/${active.site}"
              checkreturn="true"
        />
    </target>

    <target name="drush:update-database" description="Run all the database updates for the project.">
        <property name="active.site" value="default" />
        <fail unless="active.site" message="Active site not set." />
        <exec passthru="true"
              command="${bin.drush} updatedb -y"
              dir="${dir.web.root}/sites/${active.site}"
              checkreturn="true"
        />
    </target>

    <target name="drush:cron" description="Run the cron for the project.">
        <property name="active.site" value="default" />
        <fail unless="active.site" message="Active site not set." />
        <exec passthru="true"
              command="${bin.drush} cron -y"
              dir="${dir.web.root}/sites/${active.site}"
              checkreturn="true"
        />
    </target>

    <target name="drush:site-install" description="Install the project.">
        <property name="active.site" value="default" />
        <property name="install.profile" value="config_installer" />
        <fail unless="active.site" message="Active site not set." />
        <exec passthru="true"
              command="${bin.drush} site-install -y ${install.profile}"
              dir="${dir.web.root}/sites/${active.site}"
              checkreturn="true"
        />
    </target>

    <target name="drush:status" description="Display the status for the project.">
        <property name="active.site" value="default" />
        <fail unless="active.site" message="Active site not set." />
        <exec passthru="true"
              command="${bin.drush} status --sites-subdir=${active.site}"
              dir="${dir.web.root}"
              checkreturn="true"
        />
    </target>

    <target name="drush:help" description="Display the help for all the drush commands in the project.">
        <exec passthru="true" command="${bin.phing} -l" />
    </target>
</project>
